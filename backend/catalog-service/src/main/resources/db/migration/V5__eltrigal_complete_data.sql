-- =====================================================
-- Catalog Service - El Trigal Complete Demo Data
-- Categories + Products Update for admin@eltrigal.cl
-- Tenant ID: a1000000-0000-0000-0000-000000000001
-- =====================================================

-- =====================================================
-- CATEGORIES for El Trigal Bakery
-- =====================================================

INSERT INTO categories (id, tenant_id, nombre, descripcion, orden, activa, created_at)
VALUES
    ('c1000000-0000-0000-0000-000000000001', 'a1000000-0000-0000-0000-000000000001', 
     'Panadería', 'Panes frescos del día', 1, true, NOW()),
    ('c1000000-0000-0000-0000-000000000002', 'a1000000-0000-0000-0000-000000000001', 
     'Pastelería', 'Tortas, pasteles y dulces', 2, true, NOW()),
    ('c1000000-0000-0000-0000-000000000003', 'a1000000-0000-0000-0000-000000000001', 
     'Empanadas', 'Empanadas de horno y fritas', 3, true, NOW()),
    ('c1000000-0000-0000-0000-000000000004', 'a1000000-0000-0000-0000-000000000001', 
     'Cafetería', 'Café, té y bebidas calientes', 4, true, NOW()),
    ('c1000000-0000-0000-0000-000000000005', 'a1000000-0000-0000-0000-000000000001', 
     'Bebidas Frías', 'Gaseosas, jugos y agua', 5, true, NOW()),
    ('c1000000-0000-0000-0000-000000000006', 'a1000000-0000-0000-0000-000000000001', 
     'Galletas', 'Galletas artesanales', 6, true, NOW())
ON CONFLICT DO NOTHING;

-- =====================================================
-- Update existing products with categories
-- =====================================================

UPDATE products SET category_id = 'c1000000-0000-0000-0000-000000000001' 
WHERE tenant_id = 'a1000000-0000-0000-0000-000000000001' AND sku LIKE 'PAN%';

UPDATE products SET category_id = 'c1000000-0000-0000-0000-000000000002' 
WHERE tenant_id = 'a1000000-0000-0000-0000-000000000001' AND sku IN ('PAS-006', 'PAS-007', 'PAS-003');

UPDATE products SET category_id = 'c1000000-0000-0000-0000-000000000003' 
WHERE tenant_id = 'a1000000-0000-0000-0000-000000000001' AND sku IN ('PAS-004', 'PAS-005');

UPDATE products SET category_id = 'c1000000-0000-0000-0000-000000000004' 
WHERE tenant_id = 'a1000000-0000-0000-0000-000000000001' AND sku IN ('BEB-003', 'BEB-004');

UPDATE products SET category_id = 'c1000000-0000-0000-0000-000000000005' 
WHERE tenant_id = 'a1000000-0000-0000-0000-000000000001' AND sku IN ('BEB-005', 'BEB-006');

-- =====================================================
-- Additional Products for El Trigal
-- =====================================================

INSERT INTO products (id, tenant_id, sku, nombre, descripcion, category_id, unit_id, activo, created_at)
VALUES
    -- More Breads - Panadería
    ('b2001000-0000-0000-0000-000000000001', 'a1000000-0000-0000-0000-000000000001', 
     'PAN-007', 'Marraqueta Kilo', 'Pan marraqueta tradicional por kilo', 'c1000000-0000-0000-0000-000000000001', 'a0000000-0000-0000-0000-000000000002', true, NOW()),
    ('b2001000-0000-0000-0000-000000000002', 'a1000000-0000-0000-0000-000000000001', 
     'PAN-008', 'Hallulla Kilo', 'Pan hallulla por kilo', 'c1000000-0000-0000-0000-000000000001', 'a0000000-0000-0000-0000-000000000002', true, NOW()),
    ('b2001000-0000-0000-0000-000000000003', 'a1000000-0000-0000-0000-000000000001', 
     'PAN-009', 'Pan Integral', 'Pan integral de molde 600g', 'c1000000-0000-0000-0000-000000000001', 'a0000000-0000-0000-0000-000000000001', true, NOW()),
    ('b2001000-0000-0000-0000-000000000004', 'a1000000-0000-0000-0000-000000000001', 
     'PAN-010', 'Pan Centeno', 'Pan de centeno artesanal', 'c1000000-0000-0000-0000-000000000001', 'a0000000-0000-0000-0000-000000000001', true, NOW()),
    ('b2001000-0000-0000-0000-000000000005', 'a1000000-0000-0000-0000-000000000001', 
     'PAN-011', 'Coliza', 'Pan coliza tradicional', 'c1000000-0000-0000-0000-000000000001', 'a0000000-0000-0000-0000-000000000001', true, NOW()),

    -- Pastelería
    ('b2002000-0000-0000-0000-000000000001', 'a1000000-0000-0000-0000-000000000001', 
     'PAS-008', 'Torta de Chocolate', 'Torta 3 leches chocolate 12 porciones', 'c1000000-0000-0000-0000-000000000002', 'a0000000-0000-0000-0000-000000000001', true, NOW()),
    ('b2002000-0000-0000-0000-000000000002', 'a1000000-0000-0000-0000-000000000001', 
     'PAS-009', 'Torta Mil Hojas', 'Mil hojas tradicional 8 porciones', 'c1000000-0000-0000-0000-000000000002', 'a0000000-0000-0000-0000-000000000001', true, NOW()),
    ('b2002000-0000-0000-0000-000000000003', 'a1000000-0000-0000-0000-000000000001', 
     'PAS-010', 'Kuchen Manzana', 'Kuchen de manzana casero', 'c1000000-0000-0000-0000-000000000002', 'a0000000-0000-0000-0000-000000000001', true, NOW()),
    ('b2002000-0000-0000-0000-000000000004', 'a1000000-0000-0000-0000-000000000001', 
     'PAS-011', 'Alfajor', 'Alfajor de manjar casero', 'c1000000-0000-0000-0000-000000000002', 'a0000000-0000-0000-0000-000000000001', true, NOW()),
    ('b2002000-0000-0000-0000-000000000005', 'a1000000-0000-0000-0000-000000000001', 
     'PAS-012', 'Rosca Chilena', 'Rosca de chicharrones tradicional', 'c1000000-0000-0000-0000-000000000002', 'a0000000-0000-0000-0000-000000000001', true, NOW()),

    -- Empanadas
    ('b2003000-0000-0000-0000-000000000001', 'a1000000-0000-0000-0000-000000000001', 
     'EMP-001', 'Empanada Napolitana', 'Empanada de tomate, queso y jamón', 'c1000000-0000-0000-0000-000000000003', 'a0000000-0000-0000-0000-000000000001', true, NOW()),
    ('b2003000-0000-0000-0000-000000000002', 'a1000000-0000-0000-0000-000000000001', 
     'EMP-002', 'Empanada Camarón Queso', 'Empanada de camarones con queso', 'c1000000-0000-0000-0000-000000000003', 'a0000000-0000-0000-0000-000000000001', true, NOW()),
    ('b2003000-0000-0000-0000-000000000003', 'a1000000-0000-0000-0000-000000000001', 
     'EMP-003', 'Empanada Pollo', 'Empanada de pollo mechado', 'c1000000-0000-0000-0000-000000000003', 'a0000000-0000-0000-0000-000000000001', true, NOW()),

    -- Cafetería
    ('b2004000-0000-0000-0000-000000000001', 'a1000000-0000-0000-0000-000000000001', 
     'CAF-001', 'Café Espresso', 'Café espresso simple', 'c1000000-0000-0000-0000-000000000004', 'a0000000-0000-0000-0000-000000000001', true, NOW()),
    ('b2004000-0000-0000-0000-000000000002', 'a1000000-0000-0000-0000-000000000001', 
     'CAF-002', 'Café Cortado', 'Espresso con un toque de leche', 'c1000000-0000-0000-0000-000000000004', 'a0000000-0000-0000-0000-000000000001', true, NOW()),
    ('b2004000-0000-0000-0000-000000000003', 'a1000000-0000-0000-0000-000000000001', 
     'CAF-003', 'Té Negro', 'Té negro con limón o leche', 'c1000000-0000-0000-0000-000000000004', 'a0000000-0000-0000-0000-000000000001', true, NOW()),
    ('b2004000-0000-0000-0000-000000000004', 'a1000000-0000-0000-0000-000000000001', 
     'CAF-004', 'Milo Caliente', 'Milo con leche', 'c1000000-0000-0000-0000-000000000004', 'a0000000-0000-0000-0000-000000000001', true, NOW()),

    -- Galletas
    ('b2005000-0000-0000-0000-000000000001', 'a1000000-0000-0000-0000-000000000001', 
     'GAL-001', 'Galletas de Avena', 'Galletas de avena con pasas (6 unidades)', 'c1000000-0000-0000-0000-000000000006', 'a0000000-0000-0000-0000-000000000001', true, NOW()),
    ('b2005000-0000-0000-0000-000000000002', 'a1000000-0000-0000-0000-000000000001', 
     'GAL-002', 'Galletas Chips', 'Galletas con chips de chocolate (6 unidades)', 'c1000000-0000-0000-0000-000000000006', 'a0000000-0000-0000-0000-000000000001', true, NOW()),
    ('b2005000-0000-0000-0000-000000000003', 'a1000000-0000-0000-0000-000000000001', 
     'GAL-003', 'Galletas Mantequilla', 'Galletas de mantequilla artesanales', 'c1000000-0000-0000-0000-000000000006', 'a0000000-0000-0000-0000-000000000001', true, NOW())
ON CONFLICT DO NOTHING;

-- =====================================================
-- Variants with prices for new products
-- =====================================================

INSERT INTO product_variants (id, product_id, tenant_id, sku, precio_neto, precio_bruto, costo, stock_minimo, activo, es_default, created_at)
VALUES
    -- Panes por Kilo
    ('d2001000-0000-0000-0000-000000000001', 'b2001000-0000-0000-0000-000000000001', 
     'a1000000-0000-0000-0000-000000000001', 'PAN-007', 1681, 2000, 1000, 10, true, true, NOW()),
    ('d2001000-0000-0000-0000-000000000002', 'b2001000-0000-0000-0000-000000000002', 
     'a1000000-0000-0000-0000-000000000001', 'PAN-008', 1681, 2000, 1000, 10, true, true, NOW()),
    ('d2001000-0000-0000-0000-000000000003', 'b2001000-0000-0000-0000-000000000003', 
     'a1000000-0000-0000-0000-000000000001', 'PAN-009', 2101, 2500, 1500, 8, true, true, NOW()),
    ('d2001000-0000-0000-0000-000000000004', 'b2001000-0000-0000-0000-000000000004', 
     'a1000000-0000-0000-0000-000000000001', 'PAN-010', 2521, 3000, 1800, 5, true, true, NOW()),
    ('d2001000-0000-0000-0000-000000000005', 'b2001000-0000-0000-0000-000000000005', 
     'a1000000-0000-0000-0000-000000000001', 'PAN-011', 252, 300, 150, 30, true, true, NOW()),

    -- Pastelería
    ('d2002000-0000-0000-0000-000000000001', 'b2002000-0000-0000-0000-000000000001', 
     'a1000000-0000-0000-0000-000000000001', 'PAS-008', 16807, 20000, 10000, 2, true, true, NOW()),
    ('d2002000-0000-0000-0000-000000000002', 'b2002000-0000-0000-0000-000000000002', 
     'a1000000-0000-0000-0000-000000000001', 'PAS-009', 12605, 15000, 8000, 2, true, true, NOW()),
    ('d2002000-0000-0000-0000-000000000003', 'b2002000-0000-0000-0000-000000000003', 
     'a1000000-0000-0000-0000-000000000001', 'PAS-010', 5042, 6000, 3500, 3, true, true, NOW()),
    ('d2002000-0000-0000-0000-000000000004', 'b2002000-0000-0000-0000-000000000004', 
     'a1000000-0000-0000-0000-000000000001', 'PAS-011', 588, 700, 400, 20, true, true, NOW()),
    ('d2002000-0000-0000-0000-000000000005', 'b2002000-0000-0000-0000-000000000005', 
     'a1000000-0000-0000-0000-000000000001', 'PAS-012', 2521, 3000, 1500, 5, true, true, NOW()),

    -- Empanadas
    ('d2003000-0000-0000-0000-000000000001', 'b2003000-0000-0000-0000-000000000001', 
     'a1000000-0000-0000-0000-000000000001', 'EMP-001', 1681, 2000, 900, 20, true, true, NOW()),
    ('d2003000-0000-0000-0000-000000000002', 'b2003000-0000-0000-0000-000000000002', 
     'a1000000-0000-0000-0000-000000000001', 'EMP-002', 2521, 3000, 1500, 15, true, true, NOW()),
    ('d2003000-0000-0000-0000-000000000003', 'b2003000-0000-0000-0000-000000000003', 
     'a1000000-0000-0000-0000-000000000001', 'EMP-003', 1681, 2000, 1000, 20, true, true, NOW()),

    -- Cafetería
    ('d2004000-0000-0000-0000-000000000001', 'b2004000-0000-0000-0000-000000000001', 
     'a1000000-0000-0000-0000-000000000001', 'CAF-001', 1009, 1200, 300, 0, true, true, NOW()),
    ('d2004000-0000-0000-0000-000000000002', 'b2004000-0000-0000-0000-000000000002', 
     'a1000000-0000-0000-0000-000000000001', 'CAF-002', 1261, 1500, 400, 0, true, true, NOW()),
    ('d2004000-0000-0000-0000-000000000003', 'b2004000-0000-0000-0000-000000000003', 
     'a1000000-0000-0000-0000-000000000001', 'CAF-003', 840, 1000, 200, 0, true, true, NOW()),
    ('d2004000-0000-0000-0000-000000000004', 'b2004000-0000-0000-0000-000000000004', 
     'a1000000-0000-0000-0000-000000000001', 'CAF-004', 1261, 1500, 500, 0, true, true, NOW()),

    -- Galletas
    ('d2005000-0000-0000-0000-000000000001', 'b2005000-0000-0000-0000-000000000001', 
     'a1000000-0000-0000-0000-000000000001', 'GAL-001', 1681, 2000, 1000, 10, true, true, NOW()),
    ('d2005000-0000-0000-0000-000000000002', 'b2005000-0000-0000-0000-000000000002', 
     'a1000000-0000-0000-0000-000000000001', 'GAL-002', 1681, 2000, 1000, 10, true, true, NOW()),
    ('d2005000-0000-0000-0000-000000000003', 'b2005000-0000-0000-0000-000000000003', 
     'a1000000-0000-0000-0000-000000000001', 'GAL-003', 1261, 1500, 700, 10, true, true, NOW())
ON CONFLICT DO NOTHING;

-- =====================================================
-- Stock for new products
-- =====================================================

INSERT INTO stock (id, tenant_id, variant_id, branch_id, cantidad_actual, cantidad_reservada, created_at)
SELECT 
    gen_random_uuid(),
    'a1000000-0000-0000-0000-000000000001',
    pv.id,
    'a2000000-0000-0000-0000-000000000001',
    CASE 
        WHEN pv.sku LIKE 'PAN%' THEN floor(random() * 60 + 40)::int
        WHEN pv.sku LIKE 'PAS%' THEN floor(random() * 15 + 5)::int
        WHEN pv.sku LIKE 'EMP%' THEN floor(random() * 30 + 20)::int
        WHEN pv.sku LIKE 'CAF%' THEN 999
        WHEN pv.sku LIKE 'GAL%' THEN floor(random() * 25 + 15)::int
        ELSE 25
    END,
    0,
    NOW()
FROM product_variants pv
WHERE pv.tenant_id = 'a1000000-0000-0000-0000-000000000001'
  AND pv.id::text LIKE 'd2%'
ON CONFLICT DO NOTHING;
